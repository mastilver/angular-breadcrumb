/*! angular-breadcrumb - v0.2.2-dev-2014-06-23
* https://github.com/ncuillery/angular-breadcrumb
* Copyright (c) 2014 Nicolas Cuillery; Licensed MIT */
!function(a,b){function c(a,c){return b.equals(a.length,c.length)?a>c:a.length>c.length}function d(){var a={prefixStateName:null,template:"bootstrap3",templateUrl:null};this.setOptions=function(c){b.extend(a,c)},this.$get=["$state","$rootScope",function(b,d){var e=d;d.$on("$viewContentLoaded",function(a){c(a.targetScope.$id,e.$id)&&(e=a.targetScope)});var f=function(a,b){if(!a.data||!a.data[b])return!1;var c=g(a);return!(c&&c.data&&c.data[b]&&a.data[b]===c.data[b])},g=function(a){var c=a.parent||(/^(.+)\.[^.]+$/.exec(a.name)||[])[1];return c&&b.get(c)},h=function(a,c){c.ncyBreadcrumbLink=b.href(c.name);for(var d=0,e=a.length;e>d;d+=1)if(a[d].name===c.name)return;c.abstract||f(c,"ncyBreadcrumbSkip")||a.unshift(c)},i=function(a){return f(a,"ncyBreadcrumbParent")?b.get(a.data.ncyBreadcrumbParent):g(a)};return{getTemplate:function(b){return a.templateUrl?null:b[a.template]?b[a.template]:a.template},getTemplateUrl:function(){return a.templateUrl},getStatesChain:function(){for(var c=[],d=b.$current.self;d&&""!==d.name;d=i(d))h(c,d);if(a.prefixStateName){var e=b.get(a.prefixStateName);if(!e)throw'Bad configuration : prefixState "'+a.prefixStateName+'" unknown';h(c,e)}return c},$getLastViewScope:function(){return e}}}]}function e(a,c,d){return this.$$templates={bootstrap2:'<ul class="breadcrumb"><li ng-repeat="step in steps | limitTo:(steps.length-1)"><a href="{{step.ncyBreadcrumbLink}}">{{step.ncyBreadcrumbLabel}}</a> <span class="divider">/</span></li><li ng-repeat="step in steps | limitTo:-1" class="active"><span>{{step.ncyBreadcrumbLabel}}</span></li></ul>',bootstrap3:'<ol class="breadcrumb"><li ng-repeat="step in steps" ng-class="{active: $last}" ng-switch="$last"><a ng-switch-when="false" href="{{step.ncyBreadcrumbLink}}">{{step.ncyBreadcrumbLabel}}</a> <span ng-switch-when="true">{{step.ncyBreadcrumbLabel}}</span></li></ol>'},{restrict:"AE",replace:!0,scope:{},template:c.getTemplate(this.$$templates),templateUrl:c.getTemplateUrl(),link:{post:function(e){var f=[],g=function(a){if(a.expressions)return a.expressions;var c=[];return b.forEach(a.parts,function(a){b.isFunction(a)&&c.push(a.exp)}),c},h=function(a,c,d){b.forEach(g(a),function(b){var e=c.$watch(b,function(){d.ncyBreadcrumbLabel=a(c)});f.push(e)})},i=function(){b.forEach(f,function(a){a()}),f=[]},j=function(){i();var d=c.$getLastViewScope();e.steps=c.getStatesChain(),b.forEach(e.steps,function(b){if(b.data&&b.data.ncyBreadcrumbLabel){var c=a(b.data.ncyBreadcrumbLabel);b.ncyBreadcrumbLabel=c(d),h(c,d,b)}else b.ncyBreadcrumbLabel=b.name})};d.$on("$viewContentLoaded",function(){j()}),j()}}}}e.$inject=["$interpolate","$breadcrumb","$rootScope"],b.module("ncy-angular-breadcrumb",["ui.router.state"]).provider("$breadcrumb",d).directive("ncyBreadcrumb",e)}(window,window.angular);